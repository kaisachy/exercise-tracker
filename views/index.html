<!DOCTYPE html>
<html>
<head>
  <title>Exercise Tracker</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    form { margin-bottom: 20px; padding: 15px; background: #f5f5f5; border-radius: 5px; }
    input, button { padding: 8px; margin: 5px; }
    pre { background: #eee; padding: 10px; overflow: auto; }
  </style>
</head>
<body>
  <h1>Exercise Tracker</h1>
  
  <!-- Create User Form -->
  <form id="userForm">
    <h2>Create User</h2>
    <input type="text" name="username" placeholder="Username" required>
    <button type="submit">Create User</button>
  </form>
  
  <!-- Add Exercise Form -->
  <form id="exerciseForm">
    <h2>Add Exercise</h2>
    <input type="text" name="userId" placeholder="User ID" required>
    <input type="text" name="description" placeholder="Description" required>
    <input type="number" name="duration" placeholder="Duration (mins)" required>
    <input type="date" name="date">
    <button type="submit">Add Exercise</button>
  </form>
  
  <!-- Get Log Form -->
  <form id="logForm">
    <h2>Get Exercise Log</h2>
    <input type="text" name="userId" placeholder="User ID" required>
    <input type="date" name="from">
    <input type="date" name="to">
    <input type="number" name="limit" placeholder="Limit">
    <button type="submit">Get Log</button>
  </form>
  
  <div id="result"></div>
  
  <script>
    document.getElementById('userForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const username = e.target.username.value;
      const response = await fetch('/api/users', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username })
      });
      showResult(await response.json());
    });

    document.getElementById('exerciseForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(e.target);
      const data = Object.fromEntries(formData.entries());
      const response = await fetch(`/api/users/${data.userId}/exercises`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });
      showResult(await response.json());
    });

    document.getElementById('logForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(e.target);
      const params = new URLSearchParams();
      for (const [key, value] of formData.entries()) {
        if (value) params.append(key, value);
      }
      const response = await fetch(`/api/users/${formData.get('userId')}/logs?${params}`);
      showResult(await response.json());
    });

    function showResult(data) {
      document.getElementById('result').innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
    }
  </script>
</body>
</html>